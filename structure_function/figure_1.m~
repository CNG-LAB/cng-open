% Fig 1. Structure-function coupling and heritability in human cortical 
% regions. A) Microstructural profile covariance (MPC) was chosen to map 
% networks of microstructural similarity for each cortical node, sorted 
% along cytoarchitectural class 22,59; B) Resting-state functional connectivity (rsFC) analysis maps nodal patterns of intrinsic functional connectivity, sorted along cytoarchitectural class; C) Row-wise coupling of MPC and rsFC Middle: raincloud plot of distribution within cytoarchitectural classes of coupling in the 400 Schaefer parcels, box shows the median and interquartile (25-75%) range, whiskers depict the 1.5*interquartile range (IQR) from the quartiles; Right: Reference visualization cytoarchitectural class. Source data are provided as a Source Data file.

% compute the correlation between microstructure profile covariance and
% functional connectivity

% make the mean maps of both metrics
fc400m = squeeze(mean(fc400z(keep,:,:),1));
MPCm = squeeze(mean(MPC(keep,:,:),1));

% correlate both metrics
for i = 1:400
    [r p] = corr(fc400m(i,:)',MPCm(i,:)','type','spearman')
    fc_mpc(i) = r;
end

fsa5_map = zeros(1,20484);
for i = 1:200
    fsa5_map(:,find(parcels400==i+1)) = fc_mpc(i);
end
for i = 1:200
    fsa5_map(:,find(parcels400==i+1001)) = fc_mpc(i+200);
end

f = figure,
BoSurfStatViewData(fsa5_map,SN,'')
colormap(flipud(cbrewer('div','RdBu',99)))



